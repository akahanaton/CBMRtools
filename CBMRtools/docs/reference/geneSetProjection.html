<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>geneSetProjection <U+2014> geneSetProjection <e2><80><a2> CBMRtools</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">CBMRtools</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>geneSetProjection</h1>
    </div>

    
    <p><code>geneSetProjection</code> maps a gene-level dataset to a
geneset-level dataset based on control-treatment pairing (i.e., the
ks score is done with respect to the 'control vs. treatment'
phenotype).  It can be used to carry out 'single sample projection'
(the average of all samples is used as controls), as well as with
'time-series' data of response to treatment, where for each time
point there are several replicates for both the control and the
treated.</p>
    

    <pre><span class='fu'>geneSetProjection</span>(<span class='no'>dat</span>, <span class='no'>pairing</span>, <span class='no'>GS</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"ks"</span>, <span class='st'>"logistic"</span>, <span class='st'>"median"</span>,
  <span class='st'>"mean"</span>), <span class='kw'>collapse</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>weighted</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>absolute</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>min.gset</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>dat</dt>
      <dd><p>ExpressionSet data object ( require(biobase) )</p></dd>
      <dt>pairing</dt>
      <dd><p>list with pairing between treatment and control (see format below)</p></dd>
      <dt>method</dt>
      <dd><p>one of "ks","logistic","median","mean" (only ks implemented so far)</p></dd>
      <dt>collapse</dt>
      <dd><p>collapse multiple replicates into a single output vector (TRUE)</p></dd>
      <dt>weighted</dt>
      <dd><p>gsea-like weighting of KS score (TRUE)</p></dd>
      <dt>absolute</dt>
      <dd><p>use absolute values when calculating the KS score ignoring up and down (FALSE)</p></dd>
      <dt>verbose</dt>
      <dd><p>verbosity on/off (TRUE)</p></dd>
      <dt>gsets</dt>
      <dd><p>GeneSet data object (see GeneSet.R)</p></dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an expression set</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The format of 'pairing' is a list of lists (of sample names), of the form:</p>
<p>list(group1=list(control=c(s_111,..,s_11n),treatment=c(s_121,..,s_12n)),
       group2=list(control=c(s_211,..,s_21n),treatment=c(s_221,..,s_22n)),
       ...)</p>
<p>And the output ExpressionSet will have as many columns as either
the number of groups (if collapse=TRUE), or the number of samples
across all treatment groups (if collapse=FALSE)</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># the very basic steps are:</span>

<span class='co'># 1) load the data (expression and genesets)</span>
<span class='co'># 2) rename the dataset by replacing probesetIDs by gene symbols ==&gt; DB</span>
<span class='co'># 3) create the list of lists pairing ==&gt; PAIRS</span>
<span class='co'># 4) run geneSetProjection(dat=DB,pairing=PAIRS,gset.db=GSET, ...)</span>

<span class='co'>## 1) LOAD the data</span>
<span class='co'>##</span>
<span class='fu'>data</span>(<span class='no'>gspData</span>)
<span class='kw'>if</span> (<span class='fu'>is.null</span>(<span class='no'>gsp.eSet</span>)) <span class='fu'>stop</span>(<span class='st'>"is.null(gsp.eSet)"</span>)
<span class='kw'>if</span> (<span class='fu'>is.null</span>(<span class='no'>gsp.GeneSet</span>)) <span class='fu'>stop</span>(<span class='st'>"is.null(gsp.GeneSet)"</span>)

<span class='co'>## 2) RENAME the dataset rows (w/ gene symbols)</span>

<span class='no'>DAT1</span> <span class='kw'>&lt;-</span> <span class='no'>gsp.eSet</span>[<span class='fu'>fData</span>(<span class='no'>gsp.eSet</span>)[,<span class='st'>"symbol"</span>]<span class='kw'>!=</span><span class='st'>""</span>,]
<span class='fu'>exprs</span>(<span class='no'>DAT1</span>) <span class='kw'>&lt;-</span> <span class='fu'>log2</span>(<span class='fu'>exprs</span>(<span class='no'>DAT1</span>)+<span class='fl'>1</span>)
<span class='fu'>featureNames</span>(<span class='no'>DAT1</span>) <span class='kw'>&lt;-</span> <span class='fu'>toupper</span>(<span class='fu'>fData</span>(<span class='no'>DAT1</span>)[,<span class='st'>"symbol"</span>])

<span class='co'>## 3) CREATE the list of lists pairing (one group only)</span>

<span class='no'>ANidx</span> <span class='kw'>&lt;-</span> <span class='fu'>pData</span>(<span class='no'>DAT1</span>)[,<span class='st'>"tissue_type"</span>]<span class='kw'>==</span><span class='st'>"AN"</span>
<span class='no'>PAIRS</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>OSCC</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>control</span><span class='kw'>=</span><span class='fu'>sampleNames</span>(<span class='no'>DAT1</span>)[<span class='no'>ANidx</span>],
                        <span class='kw'>treatment</span><span class='kw'>=</span><span class='fu'>sampleNames</span>(<span class='no'>DAT1</span>)[!<span class='no'>ANidx</span>]))

<span class='co'>## 4) RUN geneSetProjection ..</span>
<span class='co'>##</span>

<span class='no'>GSPdir</span> <span class='kw'>&lt;-</span> <span class='fu'>geneSetProjection</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>DAT1</span>,
                            <span class='kw'>pairing</span><span class='kw'>=</span><span class='no'>PAIRS</span>,
                            <span class='kw'>GS</span><span class='kw'>=</span><span class='no'>gsp.GeneSet</span>,
                            <span class='kw'>collapse</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='co'># single-sample projection</span>
                            <span class='kw'>weighted</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='co'># standard KS score, no weighting</span>
                            <span class='kw'>absolute</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='co'># keep sign of enrichment scores</span>
                            <span class='kw'>min.gset</span><span class='kw'>=</span><span class='fl'>5</span>,
                            <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Projecting 1 groups ..
#&gt;   &gt; group OSCC .. [ 31 / 315 ]
#&gt; 	Checking genesets ..	Done checking.
#&gt; .......................................................................................................................................................................................................................................................................................................................................................... done.</div><div class='input'>
<span class='co'>## shortening pathway names for better visualization</span>
<span class='fu'>featureNames</span>(<span class='no'>GSPdir</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"WNT_BCATENIN"</span>,<span class='st'>"BCATENIN.CSNK1E"</span>,<span class='st'>"BCATENIN.CTBP1"</span>,<span class='st'>"TGF_BETA"</span>)

<span class='no'>gradeID</span> <span class='kw'>&lt;-</span> <span class='st'>'my_grade'</span>
<span class='no'>stageID</span> <span class='kw'>&lt;-</span> <span class='st'>'my_stage'</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='heatmap.ggplot2.html'>heatmap.ggplot2</a></span>(<span class='kw'>eSet</span><span class='kw'>=</span><span class='no'>GSPdir</span>,<span class='kw'>col.clust</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>row.clust</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
                      <span class='kw'>col.lab</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='no'>gradeID</span>,<span class='no'>stageID</span>),<span class='kw'>row.lab</span><span class='kw'>=</span><span class='st'>""</span>,
                      <span class='kw'>heatmap.y.text</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>heatmap.x.text</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
                      <span class='kw'>heatmap.colorlegend.name</span><span class='kw'>=</span><span class='st'>"RNASeq_expression"</span>,
                      <span class='kw'>title.text</span><span class='kw'>=</span><span class='st'>"TCGA BRCA log2 gene set projection"</span>,
                      <span class='kw'>col.legend.name</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='no'>gradeID</span>,<span class='no'>stageID</span>), <span class='kw'>row.legend.name</span><span class='kw'>=</span><span class='st'>""</span>,
                      <span class='kw'>row.scaling</span><span class='kw'>=</span><span class='st'>"none"</span>,<span class='kw'>z.norm</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
                      <span class='kw'>cuttree.col</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>cuttree.row</span><span class='kw'>=</span><span class='fl'>0</span>,
                      <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: `axis.ticks.margin` is deprecated. Please set `margin` property  of `axis.text` instead</span></div><div class='output co'>#&gt; <span class='warning'>Warning: `panel.margin` is deprecated. Please use `panel.spacing` property instead</span></div><div class='output co'>#&gt; <span class='warning'>Warning: `legend.margin` must be specified using `margin()`. For the old behavior use legend.spacing</span></div><div class='output co'>#&gt; TableGrob (2 x 1) "arrange": 2 grobs
#&gt;   z     cells    name               grob
#&gt; 1 1 (1-1,1-1) arrange text[GRID.text.12]
#&gt; 2 2 (2-2,1-1) arrange    gtable[arrange]</div><div class='input'><span class='fu'>grid.arrange</span>(<span class='no'>p2</span>)</div><img src='geneSetProjection-9.png' alt='' width='540' height='400' /><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Li Amy, Monti Stefano.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
